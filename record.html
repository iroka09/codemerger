<!DOCTYPE html>
 <html>
 <head>
	 <title>Students' Record</title>
	 <meta charset="UTF-8"/>
	 <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
	 <link rel="stylesheet" href="" type="text/css"/>
	 <style>
	 :root{
	 	font-family: sans-serif;
	 }
	 	table{
	 		width: 100%;
	 		border: 1px solid #eee;
	 		border-collapse: collapse;
	 		margin-bottom: 200px;
	 		color: #333;
	 		overflow: scroll;
	 	}
	 	th, td{
	 		text-align: center;
	 		border: 1px solid #eee;
	 		padding: 5px 0;
	 	}
	 	tr:has(th) {
	 		background: black;
	 		color: white; 
	 	}
	 	tr:has(td){
	 		opacity: 0;
	 		transform: translatex(-100px);
	 		animation: tr 1s forwards .3s;
	 	}
	 	tr:has(td):hover{
	 		border: 2px solid blue !important;
	 		font-weight: 900; 
	 		font-size: larger
	 	}
	 	@keyframes tr{
	 	 50% {
	 	 	opacity: 1;
	 	 	transform: translatex(20px);
	 	 }
	 	 90% {
	 	 	opacity: 1;
	 	 	transform: translatex(-8px);
	 	 }
	 	 100% {
	 	 	opacity: 1;
	 	 	transform: translatex(0px);
	 	 }
	 	}
	 	tbody tr:nth-child(even){
	 		background: #f1f1f1
	 	}
	 	input {
	 		border: 1px solid #aaa;
	 		border-radius: 3px;
	 		padding: 10px;
	 		display: block;
	 		transition: .2s;
	 		background: white; 
	 	}
	 	input:focus{
	 		outline: none;
	 		box-shadow: 0 0 0 2px #5cf;
	 		border: 1px solid #5cf;
	 	}
	 	button{
	 		background: black;
	 		color: white;
	 		display: block; 
	 		padding:  10px;
	 		border: none;
	 		border-radius: 2px;
			font-weight: bold;
			font-size: 1em;
	 		box-shadow: 0 1px 1px #aaa;
	 		transition: .1s
	 	}
	 	button:active{
	 		scale: 0.90;
	 		background: gray
	 	}
	 	#fixed-bottom{
	 		position: fixed;
	 		display: flex; 
	 		flex-direction: column; 
	 		align-items: center; 
	 		justify-content: center; 
	 	 	gap: 6px; 
	 	 	padding: 10px 5px; 
	 		bottom: 0;
	 		background: #2882a8; 
	 		left: 0;
	 		right: 0;
	 		box-shadow: 0 -1px 5px #ccc;
	 	}
	 	@media screen and (min-width: 300px){
	 	 #fixed-bottom {
	 		flex-direction: row; 
	 	 }
	 	 #fixed-bottom input {
	 	 	flex: 1;
	 	 }
	 	}
	 </style>
 </head>
	 <body>
	
			<table>
				<thead>
					<tr>
						<th>S/N</th>
						<th>POSITION</th>
						<th>SCORE</th>
					</tr>
				</thead>
				<tbody  id="tbody">
				</tbody>
			</table>
			
			<form id="fixed-bottom" onSubmit="event.preventDefault(); run(undefined, true)">
	 			<input  id="input" required/>
				<button>Sort Record</button>
			</form>
			
			<script>
			
		
try{

	const input = document.querySelector("#input");
	
	function availableStorage(){
		if(window.localStorage){
		 return window.localStorage
		} 
		return window.sessionStorage
	}
	
		function run(val=input.value, save){
				val = val?.trim()
				if(!val) return;
				if(save){
					availableStorage().setItem("scores", val)
				}
				let arr = val.replace(/^\D+|\D+$/g, "").split(/\s*\D+\s*|\s+/).map((x,i)=>{
					return {id: i+1, score: +x}
				});			
				arr.sort((a,b)=>{
					return a.score > b.score ? -1 : 1
				});
				arr = arr.map((a,i,w)=>{
					a.position = putSuffix(i+1);
					if(i>0 && a.score == w[i-1].score){
						a.position = w[i-1].position;
					}
					return a
				})
				const tbody = document
				.getElementById("tbody")
				tbody.innerHTML = ""
				let j = 0;
				appendFn()
				function appendFn(){
					let student = arr[j]
					const tr = document.createElement("tr");
					const td1 = document.createElement("td");
					const td2 = document.createElement("td");
					const td3 = document.createElement("td");
					td1.innerHTML = student.id;
					td2.innerHTML= student.position;
					td3.innerHTML = student.score;
					tr.append(td1)
					tr.append(td2)
					tr.append(td3)
					tbody.append(tr)
					if(j < arr.length-1){
						j++ 
						setTimeout(appendFn, 100)
					}
				}
		}
		
		
		function putSuffix(val){
			let str = val+"";
			let first = str[0];
			let last = str[str.length-1]
			let suffix = "th"
			if(last == "1" && first !== "1") suffix = "st";
			else if(last == "2" && first !== "1") suffix = "nd";
			else if(last == "3" && first !== "1") suffix = "rd";
			return str+"<sup>"+suffix+"</sup>"
		}
		
		let data = availableStorage().getItem("scores")?.trim();
		if(data){
			run(data)
		}
	
} catch(e) {
	alert(e)
}
			</script>
	 </body>
 </html>